{"version":3,"sources":["app.js"],"names":[],"mappings":"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","file":"app.js","sourcesContent":["(function (window, document, THREE) {\n  'use strict';\n\n  var parseNumericArray = function (string) {\n    return string.trim().substr(1, string.length - 2).split(',').map(function (element) {\n      return parseFloat(element);\n    });\n  };\n\n  var parseVector = function (string) {\n    var array = parseNumericArray(string);\n    return new THREE.Vector3(array[0], array[1], array[2]);\n  };\n\n  var parseQuaternion = function (string) {\n    var array = parseNumericArray(string);\n    return new THREE.Quaternion(array[1], array[2], array[3], array[0]);\n  };\n\n  var parseGeometry = function (string) {\n    var match = null;\n\n    match = string.match(/Cube{ w=(-?\\d+(?:\\.\\d+)?), h=(-?\\d+(?:\\.\\d+)?), d=(-?\\d+(?:\\.\\d+)?) }/);\n    if (match) {\n      var width = parseFloat(match[1]),\n          height = parseFloat(match[2]),\n          depth = parseFloat(match[3]);\n      return new THREE.BoxGeometry(width, height, depth);\n    }\n\n    throw 'Unable to parse shape from string: \"' + string + '\"';\n  };\n\n  function Body(id, position, rotation, geometry) {\n    this.id = id;\n    this.geometry = geometry;\n    this.material = new THREE.MeshNormalMaterial({shading: THREE.FlatShading});\n    this.states = [{\n      pos: position,\n      rot: rotation\n    }];\n\n    this.mesh = new THREE.Mesh(this.geometry, this.material);\n  }\n\n  Body.prototype.pushState = function (index, position, rotation) {\n    this.states[index] = {\n      pos: position,\n      rot: rotation\n    };\n  };\n\n  Body.prototype.useState = function (index) {\n    this.mesh.position.copy(this.states[index].pos);\n    this.mesh.quaternion.copy(this.states[index].rot);\n  };\n\n\n  function TestCase(logs) {\n    var self = this;\n    self._logs = logs;\n    self.bodies = {};\n\n    var currentStep = 0;\n    logs.split('|').forEach(function (line) {\n      var match = null,\n          id = null,\n          position = null,\n          rotation = null,\n          geometry = null;\n\n      match = line.match(/---- (.*) stdout ----/);\n      if (match) {\n        self.title = match[1];\n        return;\n      }\n\n      match = line.match(/\\[Collisions create_body\\] Body\\[(.+)\\]: Pos=(.+), Rot=(.+), Shape=(.+)/);\n      if (match) {\n        id = match[1];\n        position = parseVector(match[2]);\n        rotation = parseQuaternion(match[3]);\n        geometry = parseGeometry(match[4]);\n\n        self.bodies[id] = new Body(id, position, rotation, geometry);\n        return;\n      }\n\n      match = line.match(/\\[Dynamics update\\] START/);\n      if (match) {\n        currentStep = currentStep + 1;\n        return;\n      }\n\n      match = line.match(/\\[Dynamics update\\] Body\\[(.+)\\]: Pos=(.+), Rot=(.+)/);\n      if (match) {\n        id = match[1];\n        position = parseVector(match[2]);\n        rotation = parseQuaternion(match[3]);\n\n        self.bodies[id].pushState(currentStep, position, rotation);\n        return;\n      }\n    });\n\n    self.length = currentStep;\n  }\n\n\n  TestCase.buildFromFullLogs = function (fullLog) {\n    var matches = fullLog.match(/----.+----[\\s\\S]+/g);\n\n    return (matches || []).map(function (logs) {\n      return new TestCase(logs);\n    });\n  };\n\n\n  TestCase.prototype.prepareRender = function (scene) {\n    for (var id in this.bodies) {\n      var body = this.bodies[id];\n      body.useState(0);\n      scene.add(body.mesh);\n    }\n  };\n\n\n  var parentDiv = document.getElementById('the-display'),\n      renderer = new THREE.WebGLRenderer({\n        antialias: true,\n      }),\n      camera = new THREE.PerspectiveCamera(45, 1.0, 1, 100),\n      scene = new THREE.Scene();\n\n  camera.position.z = 5;\n  renderer.setPixelRatio(window.devicePixelRatio);\n  parentDiv.appendChild(renderer.domElement);\n\n  var animate = function () {\n    window.requestAnimationFrame(animate);\n\n    camera.aspect = parentDiv.clientWidth / parentDiv.clientHeight;\n    renderer.setSize(parentDiv.clientWidth, parentDiv.clientHeight);\n\n    renderer.render(scene, camera);\n  };\n\n  var cases = TestCase.buildFromFullLogs(document.getElementById('logs').innerText);\n  console.log(cases);\n\n  cases[0].prepareRender(scene);\n\n  animate();\n}).call(this, window, document, THREE);\n"],"sourceRoot":"/source/"}